{% extends 'base.html' %}

{% block title %}Главная — Stock AI{% endblock %}

{% block content %}
<section>
    <h1>Примеры прогнозов</h1>
    <div class="cards">
        {% for prediction in latest_predictions %}
        <article>
            <h3>{{ prediction.asset.name }} ({{ prediction.asset.ticker }})</h3>
            <p>Горизонт: {{ prediction.get_horizon_display }}</p>
            <p>
                Прогноз цены:
                <span
                    class="{% if prediction.direction == 'up' %}text-green{% elif prediction.direction == 'down' %}text-red{% else %}text-neutral{% endif %}">
                    {{ prediction.predicted_price|floatformat:2 }}
                    {% if prediction.direction == 'up' %}↑{% elif prediction.direction == 'down' %}↓{% endif %}
                </span>
            </p>
            <p>Доверие модели: {{ prediction.confidence|floatformat:2 }}</p>
            <small>Модель: {{ prediction.model_version }}</small>
        </article>
        {% empty %}
        <p>Пока нет прогнозов.</p>
        {% endfor %}
    </div>
</section>

<section>
    <h2>Статистика активов</h2>
    <div class="cards">
        {% for asset in highlighted_assets %}
        <article>
            <h3>
                {{ asset.name }}
                {% if user.is_authenticated %}
                <a href="{% url 'analytics:toggle_favorite' asset.id %}?next={{ request.path }}" 
                   style="text-decoration: none; font-size: 0.8em; margin-left: 0.5em;">
                    {% if asset.is_favorite %}★{% else %}☆{% endif %}
                </a>
                {% endif %}
            </h3>
            <p>Текущая цена: {% if asset.current_price %}{{ asset.current_price|floatformat:2 }}{% else %}—{% endif %}
                USD</p>
            <p>
                Изменение 24ч:
                {% if asset.change_24h is not None %}
                <span
                    class="{% if asset.change_24h > 0 %}text-green{% elif asset.change_24h < 0 %}text-red{% else %}text-neutral{% endif %}">
                    {{ asset.change_24h|floatformat:2 }}%
                </span>
                {% else %}
                —
                {% endif %}
            </p>

        </article>
        {% empty %}
        <p>Каталог пуст.</p>
        {% endfor %}
    </div>
</section>
{% endblock %}